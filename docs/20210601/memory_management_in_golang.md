## Garbage collection

当堆分配的某个比分比（GC百分比）完成时，该过程开始，并且收集器为完成该工作经历了不同的阶段：

1. **Mark Setup(标记设置)**（Stop the world）： 当 GC 开始时，收集器开启了写屏障，因此在接下来的并发阶段可以保持数据的完整性。这一阶段需要很小的暂停，因为每个正在运行的 Goroutine 都要被暂停，然后开始 **标记设置**, 再然后继续运行

2. **Marking（标记）**（Concurrent）: 一旦写屏障被开启，实际的标记过程并行启动应用程序使用可用的CPU处理能力的25%。对应的 P 将会被保留的直到标记完成。这个过程使用专用的 Goroutines 来完成。这里 GC 标记在 heap 中存活的值（有被活跃 Goroutines 的栈对象引用）。当收集过程花费太长时间，那么该过程将会雇佣应用程序中活跃的 Goroutine 来帮助标记处理。这被称为 Mark Assist。

3. **Mark Termination 标记结束**（Stop the world）: 标记完成后，每个活动的 Gouritne 都会暂停，写屏障关闭，清理任务开始。GC 同样会计算下一个 GC 的目标。一旦这个过程完成了，被保留的 P 将会被释放会应用程序。

4. **Sweeping（清扫）**（Concurrent）: 一旦收集完成以及尝试分配，打扫过程开始从那些没有被标记的 heap 回收内存。被清扫的内存数量和被分配的数量应该同步。